name: CI for game 2048
on:
    push:
        branches:
            - master
env:
    IMAGE_NAME: 2048
    REGISTRY: docker.io

jobs:
    build-and-push:
        name: Build and push docker images
        runs-on: ubuntu-latest
        steps:
          - name: checkout source code
            uses: actions/checkout@v4
          - name: Login to Docker Hub
            uses: docker/login-action@v3
            with:
              username: ${{secrets.DOCKER_USERNAME}}
              password: ${{secrets.DOCKER_USERNAME}}
          - name: Build Docker image
            run: |
              docker image build \
                -t ${{secrets.DOCKER_USERNAME}}/${{env.IMAGE_NAME}}:${{github.sha}} \
                -t ${{secrets.DOCKER_USERNAME}}/${{env.IMAGE_NAME}}:latest .
          - name: Push docker image
            run: |
              docker push ${{secrets.DOCKER_USERNAME}}/${{env.IMAGE_NAME}}:${{github.sha}}
              docker push ${{secrets.DOCKER_USERNAME}}/${{env.IMAGE_NAME}}:latest

